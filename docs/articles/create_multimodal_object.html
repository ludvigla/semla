<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="semla">
<title>Create a spatial multimodal object • semla</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Create a spatial multimodal object">
<meta property="og:description" content="semla">
<meta property="og:image" content="https://ludvigla.github.io/semla/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">semla</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.3.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/semla.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-tutorials">Tutorials</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-tutorials">
    <h6 class="dropdown-header" data-toc-skip>Intro</h6>
    <a class="dropdown-item" href="../articles/getting_started.html">Get started</a>
    <a class="dropdown-item" href="../articles/subset_and_merge.html">Subset/merge</a>
    <a class="dropdown-item" href="../articles/visiumHD.html">VisiumHD</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Spatial visualization</h6>
    <a class="dropdown-item" href="../articles/numeric_features.html">Map numeric features</a>
    <a class="dropdown-item" href="../articles/categorical_features.html">Map categorical features</a>
    <a class="dropdown-item" href="../articles/advanced_visualization.html">Advanced visualization</a>
    <a class="dropdown-item" href="../articles/feature_viewer.html">Feature viewer</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Spatial methods</h6>
    <a class="dropdown-item" href="../articles/radial_distances.html">Radial distances</a>
    <a class="dropdown-item" href="../articles/region_neighbors.html">Region neighbors</a>
    <a class="dropdown-item" href="../articles/spatial_statistics_for_labelled_spots.html">Statistics for labelled spots</a>
    <a class="dropdown-item" href="../articles/spatial_autocorrelation.html">Spatial autocorrelation</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Analysis</h6>
    <a class="dropdown-item" href="../articles/cell_type_mapping_with_NNLS.html">Cell type mapping</a>
    <a class="dropdown-item" href="../articles/digital_unrolling.html">Digital unrolling</a>
    <a class="dropdown-item" href="../articles/NNMF.html">Non-negative Matrix Factorization</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Image processing</h6>
    <a class="dropdown-item" href="../articles/images_and_coordinates.html">Images and spot coordinates</a>
    <a class="dropdown-item" href="../articles/mask_images.html">Image masking</a>
    <a class="dropdown-item" href="../articles/image_alignment.html">Image alignment</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/create_object.html">Create a Staffli object</a>
    <a class="dropdown-item" href="../articles/compare_cell_type_mapping_NNLS.html">Cell type mapping comparison</a>
    <a class="dropdown-item" href="../articles/cell_type_mapping_benchmark.html">Cell type mapping benchmark</a>
    <a class="dropdown-item" href="../articles/slide-seq.html">Slide-Seq data</a>
    <a class="dropdown-item" href="../articles/IF_data.html">IF data</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ludvigla/semla" aria-label="GitHub">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Create a spatial multimodal object</h1>
            
            <h4 data-toc-skip class="date">Last compiled: 19 March
2025</h4>
      
      
      <div class="d-none name"><code>create_multimodal_object.Rmd</code></div>
    </div>

    
    
<p>Recently, more and more spatial multimodal data are becoming
available, however, the alignment and processing of some of these
modalities can be challenging. One such example is the integration of
Visium data with Mass Spectrometry Imaging (MSI) data, which can
experimentally either be performed on the same or adjacent tissue
sections. These two technologies produce data with different spatial
resolution and mismatched spatial coordinate systems. In the case of MSI
data, there is further a challenge with non-standardized file
formats.</p>
<p>To perform the task of integrating two spatial omics datasets into
shared coordinates, we have developed a new function within
<code>semla</code> that joins two semla objects into a single object,
with each modality present as separate assays/layers.</p>
<p>A few pre-requisites are required before joining the two samples, the
primary one being that the spatial coordinates of the objects first
needs to have been aligned and transformed into the same pixel
dimensions. And secondly, both data sets needs to be available in the
standardized Space Ranger output file formats. To for instance obtained
aligned and properly preprocessed Visium and MSI spatial multimodal
datasets, the pipeline <em>MAGPIE</em> (unpublished) can be used to
perform these tasks in a streamlined fashion.</p>
<p>For this tutorial, we have processed mouse lung tissue with both
Visium and MSI, from consecutive sections. The MSI data was first
preprocessed and thereafter spatially aligned into the matching Visium
coordinate system using <em>MAGPIE</em>, which produces output files in
the Space Ranger format for the aligned MSI data. In this dataset, we
also have image of the H&amp;E stained tissue section that used to
obtain the MSI data.</p>
<p>Let’s get started!</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ludvigla.github.io/semla/">semla</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">col_scale_rocket</span> <span class="op">&lt;-</span> <span class="fu">viridis</span><span class="fu">::</span><span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">rocket</a></span><span class="op">(</span><span class="fl">11</span>, direction <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">col_scale_mako</span> <span class="op">&lt;-</span> <span class="fu">viridis</span><span class="fu">::</span><span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">mako</a></span><span class="op">(</span><span class="fl">11</span>, direction <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="load-data">Load data<a class="anchor" aria-label="anchor" href="#load-data"></a>
</h2>
<p>We will start by loading the two datasets, starting with the Visium
data.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">infoTable_visium</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  samples <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"multimodal_data/mm_bleo_visium"</span>, <span class="st">"filtered_feature_bc_matrix.h5"</span><span class="op">)</span>,</span>
<span>  imgs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"multimodal_data/mm_bleo_visium"</span>, <span class="st">"spatial/tissue_hires_image.png"</span><span class="op">)</span>,</span>
<span>  spotfiles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"multimodal_data/mm_bleo_visium"</span>, <span class="st">"spatial/tissue_positions_list.csv"</span><span class="op">)</span>,</span>
<span>  json <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"multimodal_data/mm_bleo_visium"</span>, <span class="st">"spatial/scalefactors_json.json"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">se_visium</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ReadVisiumData.html">ReadVisiumData</a></span><span class="op">(</span>infoTable <span class="op">=</span> <span class="va">infoTable_visium</span>, </span>
<span>                            assay <span class="op">=</span> <span class="st">"Visium"</span>, </span>
<span>                            remove_spots_outside_HE <span class="op">=</span> <span class="cn">T</span>, </span>
<span>                            remove_spots_outside_tissue <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## ── <span style="font-weight: bold;">Reading 10x Visium data</span> ──</span></span></code></pre>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Loading matrices:</span></span></code></pre>
<pre><code><span><span class="co">## →   Finished loading expression matrix 1</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span>   There are <span style="color: #5555FF;">32285</span> features and <span style="color: #FF55FF;">4108</span> spots in the expression matrix.</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Loading coordinates:</span></span></code></pre>
<pre><code><span><span class="co">## →   Finished loading coordinates for sample 1</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Collected coordinates for <span style="color: #FF55FF;">4108</span> spots.</span></span></code></pre>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## ── Creating `Seurat` object</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> Expression matrices and coordinates are compatible</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Created `Seurat` object</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Created `Staffli` object</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> Returning a `Seurat` object with <span style="color: #5555FF;">32285</span> features and <span style="color: #FF55FF;">4108</span> spots</span></span></code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/visualize-features.html">MapFeatures</a></span><span class="op">(</span><span class="va">se_visium</span>, features <span class="op">=</span> <span class="st">"nCount_Visium"</span>, colors <span class="op">=</span> <span class="va">col_scale_rocket</span><span class="op">)</span></span></code></pre></div>
<p><img src="create_multimodal_object_files/figure-html/unnamed-chunk-4-1.png" width="384"></p>
<p><br><br></p>
<p>Next, we read the MSI data available in the same stardardised Space
Ranger format. To make it easier to separate the two objects, we can
pass a unique name to the <code>assay</code> argument.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">infoTable_msi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  samples <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"multimodal_data/mm_bleo_msi"</span>, <span class="st">"filtered_feature_bc_matrix.h5"</span><span class="op">)</span>,</span>
<span>  imgs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"multimodal_data/mm_bleo_msi"</span>, <span class="st">"spatial/tissue_hires_image.png"</span><span class="op">)</span>,</span>
<span>  spotfiles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"multimodal_data/mm_bleo_msi"</span>, <span class="st">"spatial/tissue_positions_list.csv"</span><span class="op">)</span>,</span>
<span>  json <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"multimodal_data/mm_bleo_msi"</span>, <span class="st">"spatial/scalefactors_json.json"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">se_msi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ReadVisiumData.html">ReadVisiumData</a></span><span class="op">(</span>infoTable <span class="op">=</span> <span class="va">infoTable_msi</span>, </span>
<span>                         assay <span class="op">=</span> <span class="st">"MSI"</span>, </span>
<span>                         remove_spots_outside_HE <span class="op">=</span> <span class="cn">T</span>, </span>
<span>                         remove_spots_outside_tissue <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## ── <span style="font-weight: bold;">Reading 10x Visium data</span> ──</span></span></code></pre>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Loading matrices:</span></span></code></pre>
<pre><code><span><span class="co">## →   Finished loading expression matrix 1</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span>   There are <span style="color: #5555FF;">2633</span> features and <span style="color: #FF55FF;">14824</span> spots in the expression matrix.</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Loading coordinates:</span></span></code></pre>
<pre><code><span><span class="co">## →   Finished loading coordinates for sample 1</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Collected coordinates for <span style="color: #FF55FF;">14824</span> spots.</span></span></code></pre>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## ── Creating `Seurat` object</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> Expression matrices and coordinates are compatible</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #BBBB00;">!</span> Found 627 spot(s) with x coordinates outside of the H&amp;E image for sample 1</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #BBBB00;">!</span> Found 2855 spot(s) with y coordinates outside of the H&amp;E image for sample 1</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #BBBB00;">!</span> Removing 3482 spots from the dataset</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Created `Seurat` object</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Created `Staffli` object</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> Returning a `Seurat` object with <span style="color: #5555FF;">2633</span> features and <span style="color: #FF55FF;">11719</span> spots</span></span></code></pre>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/visualize-features.html">MapFeatures</a></span><span class="op">(</span><span class="va">se_msi</span>, features <span class="op">=</span> <span class="st">"nCount_MSI"</span>, colors <span class="op">=</span> <span class="va">col_scale_mako</span>, pt_size <span class="op">=</span> <span class="fl">0.6</span>, min_cutoff <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></code></pre></div>
<p><img src="create_multimodal_object_files/figure-html/unnamed-chunk-6-1.png" width="384"></p>
<p><br></p>
<p>Here we see the transformed MSI data visualized in the same manner as
we are used to see Visium data. The spatial resolution of MSI data is a
lot higher, and since the coordinates here have been aligned to match
the Visium H&amp;E image, it is no longer present in a perfect grid but
can rather appear slightly distorted.</p>
<p>If we want, we can load the MSI H&amp;E image and view it together
with the data.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">se_msi_he</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load-images.html">LoadImages</a></span><span class="op">(</span><span class="va">se_msi</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## ── <span style="font-weight: bold;">Loading H&amp;E images</span> ──</span></span></code></pre>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Loading image from multimodal_data/mm_bleo_msi/spatial/tissue_hires_image.png</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Scaled image from 1945x2000 to 400x411 pixels</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Saving loaded H&amp;E images as 'rasters' in Seurat object</span></span></code></pre>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/visualize-features.html">MapFeatures</a></span><span class="op">(</span><span class="va">se_msi_he</span>, features <span class="op">=</span> <span class="st">"nCount_MSI"</span>, colors <span class="op">=</span> <span class="va">col_scale_mako</span>, </span>
<span>            pt_size <span class="op">=</span> <span class="fl">0.4</span>,</span>
<span>            image_use <span class="op">=</span> <span class="st">"raw"</span><span class="op">)</span></span></code></pre></div>
<p><img src="create_multimodal_object_files/figure-html/unnamed-chunk-8-1.png" width="384"></p>
</div>
<div class="section level2">
<h2 id="data-processing">Data processing<a class="anchor" aria-label="anchor" href="#data-processing"></a>
</h2>
<p>Next, we will perform the standard processing of the expression data,
starting with the Visium data.</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">se_visium</span> <span class="op">&lt;-</span> <span class="va">se_visium</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://satijalab.org/seurat/reference/NormalizeData.html" class="external-link">NormalizeData</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://satijalab.org/seurat/reference/ScaleData.html" class="external-link">ScaleData</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://satijalab.org/seurat/reference/FindVariableFeatures.html" class="external-link">FindVariableFeatures</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Centering and scaling data matrix</span></span></code></pre>
<p>For the MSI data, the intensity values have already been normalized
based on total ion count prior to creating the input data. However, to
ease the integration and shorten the processing time, we will filter the
data and only include the most spatially variable metabolites.</p>
<p>First we can have a look at the distribution of metabolites and peak
intensities across pixels to thereafter determine reasonable
cutoffs.</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://satijalab.org/seurat/reference/VlnPlot.html" class="external-link">VlnPlot</a></span><span class="op">(</span><span class="va">se_msi</span>, features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"nCount_MSI"</span>, <span class="st">"nFeature_MSI"</span><span class="op">)</span>, </span>
<span>        pt.size <span class="op">=</span> <span class="fl">0</span>, </span>
<span>        ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="create_multimodal_object_files/figure-html/unnamed-chunk-10-1.png" width="384"></p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Pixel filter</span></span>
<span><span class="va">min_count_per_spot</span> <span class="op">&lt;-</span> <span class="fl">14e5</span></span>
<span><span class="va">min_peaks_per_spot</span> <span class="op">&lt;-</span> <span class="fl">300</span></span>
<span><span class="va">msi_coord_keep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">se_msi</span><span class="op">@</span><span class="va">meta.data</span>, </span>
<span>                                  <span class="va">nFeature_MSI</span> <span class="op">&gt;</span> <span class="va">min_peaks_per_spot</span> <span class="op">&amp;</span> <span class="va">nCount_MSI</span> <span class="op">&gt;</span> <span class="va">min_count_per_spot</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">se_msi_filtered</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/subset.html">SubsetSTData</a></span><span class="op">(</span><span class="va">se_msi</span>, spots <span class="op">=</span> <span class="va">msi_coord_keep</span><span class="op">)</span></span>
<span><span class="va">se_msi_filtered</span></span></code></pre></div>
<pre><code><span><span class="co">## An object of class Seurat </span></span>
<span><span class="co">## 2633 features across 10770 samples within 1 assay </span></span>
<span><span class="co">## Active assay: MSI (2633 features, 0 variable features)</span></span>
<span><span class="co">##  2 layers present: counts, data</span></span></code></pre>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Metabolite filter</span></span>
<span><span class="va">se_msi_filtered</span> <span class="op">&lt;-</span> <span class="va">se_msi_filtered</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/FindVariableFeatures.html" class="external-link">FindVariableFeatures</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">cor_features</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cor-features.html">CorSpatialFeatures</a></span><span class="op">(</span><span class="va">se_msi_filtered</span>, assay_use <span class="op">=</span> <span class="st">"MSI"</span>, slot_use <span class="op">=</span> <span class="st">"counts"</span>, verbose <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## ── <span style="font-weight: bold;">Computing spatial autocorrelation</span> ──</span></span></code></pre>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Sample 1:</span></span></code></pre>
<pre><code><span><span class="co">## →   Cleaned out spots with 0 adjacent neighbors</span></span></code></pre>
<pre><code><span><span class="co">## →   Computed feature lag expression</span></span></code></pre>
<pre><code><span><span class="co">## →   Computed feature spatial autocorrelation scores</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span>   Returning results</span></span></code></pre>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">top_n</span> <span class="op">&lt;-</span> <span class="fl">500</span></span>
<span><span class="va">top_metabolites</span> <span class="op">&lt;-</span> <span class="va">cor_features</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">top_n</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">gene</span><span class="op">)</span></span>
<span></span>
<span><span class="va">se_msi_filtered</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/subset.html">SubsetSTData</a></span><span class="op">(</span><span class="va">se_msi</span>, features <span class="op">=</span> <span class="va">top_metabolites</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="create-the-spatial-multimodal-object">Create the spatial multimodal object<a class="anchor" aria-label="anchor" href="#create-the-spatial-multimodal-object"></a>
</h2>
<p>Now, each object is ready for being joined into a single object by
using the <code><a href="../reference/multimodal-object.html">CreateMultiModalObject()</a></code> function. What this
function does, is to use the second modality object (MSI in this case)
and map it into the reference spatial object (here Visium). Since the
spatial resolution of MSI is higher than for Visium, the function will
detect and aggregate data from multiple MSI pixels per Visium spot,
taking either mean of the sum of the MSI measurements (as specified with
the <code>agg_func</code> argument).</p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">se_mmo</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/multimodal-object.html">CreateMultiModalObject</a></span><span class="op">(</span>object_ref <span class="op">=</span> <span class="va">se_visium</span>, </span>
<span>                                 object_map <span class="op">=</span> <span class="va">se_msi_filtered</span>,</span>
<span>                                 agg_func <span class="op">=</span> <span class="st">"mean"</span>, </span>
<span>                                 new_assay_name <span class="op">=</span> <span class="st">"MSI"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## ── <span style="font-weight: bold;">Joining second modality data to reference object</span> ──</span></span></code></pre>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Excluding <span style="color: #55FFFF;">4651</span> coordinates from the mapping dataset due to being outside of reference coordinate scope</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Aggregating assay data in mapping coordinates per reference coordinate (this step may take long if the data is large)</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Using 7 threads</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> Data aggregation finished in 0.1 minutes</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Storing aggregated data summarized by mean values</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Adding second modality data to a new 'Assay' named 'MSI', containing <span style="color: #5555FF;">500</span> features</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> Returning a `Seurat` object with <span style="color: #5555FF;">32285</span> features and <span style="color: #FF55FF;">4086</span> spots</span></span></code></pre>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/visualize-features.html">MapFeatures</a></span><span class="op">(</span><span class="va">se_mmo</span>, </span>
<span>            features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"nCount_Visium"</span>, <span class="st">"nFeature_Visium"</span><span class="op">)</span>, </span>
<span>            ncol <span class="op">=</span> <span class="fl">1</span>, </span>
<span>            colors <span class="op">=</span> <span class="va">col_scale_rocket</span><span class="op">)</span> <span class="op">|</span></span>
<span>  <span class="fu"><a href="../reference/visualize-features.html">MapFeatures</a></span><span class="op">(</span><span class="va">se_mmo</span>, </span>
<span>              features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"nCount_MSI"</span>, <span class="st">"nFeature_MSI"</span><span class="op">)</span>, </span>
<span>              ncol <span class="op">=</span> <span class="fl">1</span>, </span>
<span>              colors <span class="op">=</span> <span class="va">col_scale_mako</span><span class="op">)</span></span></code></pre></div>
<p><img src="create_multimodal_object_files/figure-html/unnamed-chunk-14-1.png" width="576"></p>
<p>As seen here, we now have the MSI and Visium data within the same
object and coordinate system, allowing us to perform any desired
downstream analyses, e.g. factor analysis with NMF or MOFA.</p>
<p>As with any semla object, we can read in the tissue image and in this
case the Visium H&amp;E image will be selected by default as it acted as
our reference dataset.</p>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">se_mmo</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load-images.html">LoadImages</a></span><span class="op">(</span><span class="va">se_mmo</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## ── <span style="font-weight: bold;">Loading H&amp;E images</span> ──</span></span></code></pre>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Loading image from multimodal_data/mm_bleo_visium/spatial/tissue_hires_image.png</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Scaled image from 1945x2000 to 400x411 pixels</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Saving loaded H&amp;E images as 'rasters' in Seurat object</span></span></code></pre>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spot_size</span> <span class="op">&lt;-</span> <span class="fl">0.6</span></span>
<span><span class="fu"><a href="../reference/visualize-features.html">MapFeatures</a></span><span class="op">(</span><span class="va">se_mmo</span>, </span>
<span>            features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"nCount_Visium"</span><span class="op">)</span>, pt_size <span class="op">=</span> <span class="va">spot_size</span>,</span>
<span>            colors <span class="op">=</span> <span class="va">col_scale_rocket</span>, image_use <span class="op">=</span> <span class="st">"raw"</span><span class="op">)</span> <span class="op">|</span></span>
<span>  <span class="fu"><a href="../reference/visualize-features.html">MapFeatures</a></span><span class="op">(</span><span class="va">se_mmo</span>, </span>
<span>              features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"nCount_MSI"</span><span class="op">)</span>, pt_size <span class="op">=</span> <span class="va">spot_size</span>,</span>
<span>              colors <span class="op">=</span> <span class="va">col_scale_mako</span>, image_use <span class="op">=</span> <span class="st">"raw"</span><span class="op">)</span></span></code></pre></div>
<p><img src="create_multimodal_object_files/figure-html/unnamed-chunk-16-1.png" width="576"></p>
<hr>
<details open><summary><strong>Package version</strong>
</summary><ul>
<li>
<code>semla</code>: 1.3.1</li>
</ul></details><details><summary><strong>Session info</strong>
</summary><div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## R version 4.3.3 (2024-02-29)</span></span>
<span><span class="co">## Platform: aarch64-apple-darwin20.0.0 (64-bit)</span></span>
<span><span class="co">## Running under: macOS 15.3</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS/LAPACK: /Users/javierescudero/miniconda3/envs/r-semla/lib/libopenblas.0.dylib;  LAPACK version 3.12.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## time zone: Europe/Stockholm</span></span>
<span><span class="co">## tzcode source: internal</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">## [1] patchwork_1.2.0    semla_1.3.1        ggplot2_3.5.0      dplyr_1.1.4       </span></span>
<span><span class="co">## [5] SeuratObject_5.0.1 Seurat_4.3.0.1    </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##   [1] RColorBrewer_1.1-3     rstudioapi_0.15.0      jsonlite_1.8.8        </span></span>
<span><span class="co">##   [4] magrittr_2.0.3         spatstat.utils_3.0-5   magick_2.8.3          </span></span>
<span><span class="co">##   [7] farver_2.1.1           rmarkdown_2.26         fs_1.6.3              </span></span>
<span><span class="co">##  [10] ragg_1.3.3             vctrs_0.6.5            ROCR_1.0-11           </span></span>
<span><span class="co">##  [13] memoise_2.0.1          spatstat.explore_3.2-6 htmltools_0.5.7       </span></span>
<span><span class="co">##  [16] forcats_1.0.0          sass_0.4.8             sctransform_0.4.1     </span></span>
<span><span class="co">##  [19] parallelly_1.38.0      KernSmooth_2.23-22     bslib_0.6.1           </span></span>
<span><span class="co">##  [22] htmlwidgets_1.6.4      desc_1.4.3             ica_1.0-3             </span></span>
<span><span class="co">##  [25] plyr_1.8.9             plotly_4.10.4          zoo_1.8-12            </span></span>
<span><span class="co">##  [28] cachem_1.0.8           igraph_2.0.2           mime_0.12             </span></span>
<span><span class="co">##  [31] lifecycle_1.0.4        pkgconfig_2.0.3        Matrix_1.6-3          </span></span>
<span><span class="co">##  [34] R6_2.5.1               fastmap_1.1.1          fitdistrplus_1.1-11   </span></span>
<span><span class="co">##  [37] future_1.34.0          shiny_1.8.0            digest_0.6.34         </span></span>
<span><span class="co">##  [40] colorspace_2.1-0       tensor_1.5             irlba_2.3.5.1         </span></span>
<span><span class="co">##  [43] textshaping_0.3.7      labeling_0.4.3         progressr_0.14.0      </span></span>
<span><span class="co">##  [46] fansi_1.0.6            spatstat.sparse_3.0-3  httr_1.4.7            </span></span>
<span><span class="co">##  [49] polyclip_1.10-6        abind_1.4-5            compiler_4.3.3        </span></span>
<span><span class="co">##  [52] bit64_4.0.5            withr_3.0.0            viridis_0.6.5         </span></span>
<span><span class="co">##  [55] highr_0.10             float_0.3-2            MASS_7.3-60           </span></span>
<span><span class="co">##  [58] tools_4.3.3            lmtest_0.9-40          httpuv_1.6.14         </span></span>
<span><span class="co">##  [61] future.apply_1.11.1    goftest_1.2-3          glue_1.7.0            </span></span>
<span><span class="co">##  [64] dbscan_1.1-12          nlme_3.1-164           promises_1.2.1        </span></span>
<span><span class="co">##  [67] grid_4.3.3             Rtsne_0.17             cluster_2.1.6         </span></span>
<span><span class="co">##  [70] reshape2_1.4.4         generics_0.1.3         hdf5r_1.3.10          </span></span>
<span><span class="co">##  [73] gtable_0.3.4           spatstat.data_3.0-4    tidyr_1.3.1           </span></span>
<span><span class="co">##  [76] data.table_1.15.2      sp_2.1-3               utf8_1.2.4            </span></span>
<span><span class="co">##  [79] spatstat.geom_3.2-9    RcppAnnoy_0.0.22       ggrepel_0.9.5         </span></span>
<span><span class="co">##  [82] RANN_2.6.1             pillar_1.9.0           stringr_1.5.1         </span></span>
<span><span class="co">##  [85] spam_2.10-0            later_1.3.2            splines_4.3.3         </span></span>
<span><span class="co">##  [88] lattice_0.22-5         bit_4.0.5              survival_3.5-8        </span></span>
<span><span class="co">##  [91] deldir_2.0-4           tidyselect_1.2.0       miniUI_0.1.1.1        </span></span>
<span><span class="co">##  [94] pbapply_1.7-2          knitr_1.45             gridExtra_2.3         </span></span>
<span><span class="co">##  [97] scattermore_1.2        RhpcBLASctl_0.23-42    xfun_0.42             </span></span>
<span><span class="co">## [100] matrixStats_1.2.0      stringi_1.8.3          lazyeval_0.2.2        </span></span>
<span><span class="co">## [103] yaml_2.3.8             evaluate_0.23          codetools_0.2-19      </span></span>
<span><span class="co">## [106] tibble_3.2.1           cli_3.6.2              uwot_0.1.16           </span></span>
<span><span class="co">## [109] xtable_1.8-4           reticulate_1.35.0      systemfonts_1.0.5     </span></span>
<span><span class="co">## [112] munsell_0.5.0          jquerylib_0.1.4        Rcpp_1.0.12           </span></span>
<span><span class="co">## [115] globals_0.16.3         spatstat.random_3.2-3  zeallot_0.1.0         </span></span>
<span><span class="co">## [118] png_0.1-8              parallel_4.3.3         ellipsis_0.3.2        </span></span>
<span><span class="co">## [121] pkgdown_2.0.7          dotCall64_1.1-1        listenv_0.9.1         </span></span>
<span><span class="co">## [124] viridisLite_0.4.2      MatrixExtra_0.1.15     scales_1.3.0          </span></span>
<span><span class="co">## [127] ggridges_0.5.6         leiden_0.4.3.1         purrr_1.0.2           </span></span>
<span><span class="co">## [130] rlang_1.1.3            cowplot_1.1.3          shinyjs_2.1.0</span></span></code></pre>
</details><p><br></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://github.com/ludvigla" class="external-link">Ludvig Larsson</a>, <a href="https://github.com/lfranzen" class="external-link">Lovisa Franzen</a>, <a href="https://github.com/jemorlanes" class="external-link">Javier Escudero Morlanes</a>, <a href="https://www.spatialresearch.org/" class="external-link"><img src="reference/figures/sr-logo.png" height="36" alt="spatialresearch"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
