<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="MapFeatures can be used to map numeric features to spots where the
values are encoded as colors. If multiple features and samples are provided, these
will be plotted individually and arranged into a grid of subplots."><title>Map numeric features — MapFeatures • semla</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Map numeric features — MapFeatures"><meta property="og:description" content="MapFeatures can be used to map numeric features to spots where the
values are encoded as colors. If multiple features and samples are provided, these
will be plotted individually and arranged into a grid of subplots."><meta property="og:image" content="https://ludvigla.github.io/semla/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">semla</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/semla.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-tutorials">Tutorials</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-tutorials">
    <h6 class="dropdown-header" data-toc-skip>Intro</h6>
    <a class="dropdown-item" href="../articles/getting_started.html">Get started</a>
    <a class="dropdown-item" href="../articles/subset_and_merge.html">Subset/merge</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Interactive</h6>
    <a class="dropdown-item" href="../articles/feature_viewer.html">Feature viewer</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Spatial visualization</h6>
    <a class="dropdown-item" href="../articles/numeric_features.html">Map numeric features</a>
    <a class="dropdown-item" href="../articles/categorical_features.html">Map categorical features</a>
    <a class="dropdown-item" href="../articles/advanced_visualization.html">Advanced visualization</a>
    <a class="dropdown-item" href="../articles/scalebar.html">Scalebar</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Spatial methods</h6>
    <a class="dropdown-item" href="../articles/radial_distances.html">Radial distances</a>
    <a class="dropdown-item" href="../articles/region_neighbors.html">Region neighbors</a>
    <a class="dropdown-item" href="../articles/spatial_statistics_for_labelled_spots.html">Statistics for labelled spots</a>
    <a class="dropdown-item" href="../articles/spatial_autocorrelation.html">Spatial autocorrelation</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Analysis</h6>
    <a class="dropdown-item" href="../articles/cell_type_mapping_with_NNLS.html">Cell type mapping</a>
    <a class="dropdown-item" href="../articles/digital_unrolling.html">Digital unrolling</a>
    <a class="dropdown-item" href="../articles/NNMF.html">Non-negative Matrix Factorization</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Image processing</h6>
    <a class="dropdown-item" href="../articles/images_and_coordinates.html">Images and spot coordinates</a>
    <a class="dropdown-item" href="../articles/mask_images.html">Image masking</a>
    <a class="dropdown-item" href="../articles/image_alignment.html">Image alignment</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ludvigla/semla" aria-label="GitHub">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Map numeric features</h1>
      
      <div class="d-none name"><code>visualize-features.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>MapFeatures</code> can be used to map numeric features to spots where the
values are encoded as colors. If multiple features and samples are provided, these
will be plotted individually and arranged into a grid of subplots.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">MapFeatures</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for default</span></span>
<span><span class="fu">MapFeatures</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  crop_area <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pt_size <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  pt_alpha <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  pt_stroke <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  scale_alpha <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  section_number <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  label_by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ncol <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  colors <span class="op">=</span> <span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">brewer.pal</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">9</span>, name <span class="op">=</span> <span class="st">"Reds"</span><span class="op">)</span>,</span>
<span>  center_zero <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"shared"</span>, <span class="st">"free"</span><span class="op">)</span>,</span>
<span>  arrange_features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"col"</span>, <span class="st">"row"</span><span class="op">)</span>,</span>
<span>  dims <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  coords_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pxl_col_in_fullres"</span>, <span class="st">"pxl_row_in_fullres"</span><span class="op">)</span>,</span>
<span>  return_plot_list <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  drop_na <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  blend <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  blend_order <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,</span>
<span>  add_scalebar <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  scalebar_gg <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  scalebar_height <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  scalebar_position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.8</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for Seurat</span></span>
<span><span class="fu">MapFeatures</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">features</span>,</span>
<span>  slot <span class="op">=</span> <span class="st">"data"</span>,</span>
<span>  image_use <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  coords_use <span class="op">=</span> <span class="st">"raw"</span>,</span>
<span>  crop_area <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pt_size <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  pt_alpha <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  pt_stroke <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  scale_alpha <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  section_number <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  label_by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ncol <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  colors <span class="op">=</span> <span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">brewer.pal</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">9</span>, name <span class="op">=</span> <span class="st">"Reds"</span><span class="op">)</span>,</span>
<span>  center_zero <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"shared"</span>, <span class="st">"free"</span><span class="op">)</span>,</span>
<span>  arrange_features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"col"</span>, <span class="st">"row"</span><span class="op">)</span>,</span>
<span>  drop_na <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  blend <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  blend_order <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,</span>
<span>  override_plot_dims <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  max_cutoff <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  min_cutoff <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  return_plot_list <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  add_scalebar <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  scalebar_height <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  scalebar_gg <span class="op">=</span> <span class="fu"><a href="scalebar.html">scalebar</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">500</span>, text_height <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>  scalebar_position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.7</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>object</dt>
<dd><p>An object</p></dd>


<dt>...</dt>
<dd><p>Arguments passed to other methods</p></dd>


<dt>crop_area</dt>
<dd><p>A numeric vector of length 4 specifying a rectangular area to crop
the plots by. These numbers should be within 0-1. The x-axis is goes from left=0 to
right=1 and the y axis is goes from top=0 to bottom=1. The order of the values are
specified as follows: <code>crop_area = c(left, top, right, bottom)</code>. The crop area
will be used on all tissue sections and cannot be set for each section individually.
using crop areas of different sizes on different sections can lead to unwanted side
effects as the point sizes will remain constant. In this case it is better to generate
separate plots for different tissue sections.</p></dd>


<dt>pt_size</dt>
<dd><p>A numeric value specifying the point size passed to <code>geom_point</code></p></dd>


<dt>pt_alpha</dt>
<dd><p>A numeric value between 0 and 1 specifying the point opacity passed
to <code>geom_point</code>. A value of 0 will make the points completely transparent
and a value of 1 will make the points completely opaque.</p></dd>


<dt>pt_stroke</dt>
<dd><p>A numeric specifying the point stroke width</p></dd>


<dt>scale_alpha</dt>
<dd><p>Logical specifying if the spot colors should be scaled together with
the feature values. This can be useful when you want to highlight regions with higher
feature values while making the background tissue visible.</p></dd>


<dt>section_number</dt>
<dd><p>An integer select a tissue section number to subset data by</p></dd>


<dt>label_by</dt>
<dd><p>Character of length 1 providing a column name in <code>object</code> with
labels that can be used to provide a title for each subplot. This column should have
1 label per tissue section. This can be useful when you need to provide more detailed
information about your tissue sections.</p></dd>


<dt>ncol</dt>
<dd><p>Integer value specifying the number of columns in the output patchwork.
This parameter will only have an effect when the number of features provided is 1.
Otherwise, the patchwork will be arranged based on the <code>arrange_features</code> parameter.</p></dd>


<dt>colors</dt>
<dd><p>A character vector of colors to use for the color scale. The colors should
preferably consist of a set of colors from a scientific color palette designed for sequential
data. Some useful palettes are available in the <code>RColorBrewer</code>, <code>viridis</code> and
<code>scico</code> R packages.</p></dd>


<dt>center_zero</dt>
<dd><p>A logical specifying whether the color scale should be centered at 0</p></dd>


<dt>scale</dt>
<dd><p>A character vector of length 1 specifying one of "shared" or "free" which will
determine how the color bars are structured. If scale is set to "shared", the color bars for
feature values will be shared across samples. If scale is set to "free", the color bars
will be independent.</p></dd>


<dt>arrange_features</dt>
<dd><p>One of "row" or "col". "col" will put the features in columns
and samples in rows and "row" will transpose the arrangement</p></dd>


<dt>dims</dt>
<dd><p>A tibble with information about the tissue sections. This information is used to
determine the limits of the plot area. If <code>dims</code> is not provided, the limits will be
computed directly from the spatial coordinates provided in <code>object</code>.</p></dd>


<dt>coords_columns</dt>
<dd><p>a character vector of length 2 specifying the names of the columns in
<code>object</code> holding the spatial coordinates</p></dd>


<dt>return_plot_list</dt>
<dd><p>A logical specifying if a `patchwork` or a list of `ggplot` objects should be returned.
By default, a `patchwork` is returned, but it can sometimes be useful to obtain the list of `ggplot` objects
if you want to manipulate each sub plot independently.</p></dd>


<dt>drop_na</dt>
<dd><p>A logical specifying if NA values should be dropped</p></dd>


<dt>blend</dt>
<dd><p>a logical specifying whether blending should be used. See the section about color 
blending below for more information.</p></dd>


<dt>blend_order</dt>
<dd><p>An integer vector of length 2-3 specifying the order to blend features by. Only
active when <code>blend = TRUE</code>. See color blending for more information.</p></dd>


<dt>add_scalebar</dt>
<dd><p>A logical specifying if a scale bar should be added to the plots</p></dd>


<dt>scalebar_gg</dt>
<dd><p>A 'ggplot' object generated with <code><a href="scalebar.html">scalebar</a></code>. The appearance of the scale
bar is styled by passing parameters to <code><a href="scalebar.html">scalebar</a></code>.</p></dd>


<dt>scalebar_height</dt>
<dd><p>A numeric value specifying the height of the scale bar relative to the
height of the full plot area. Has to be a value between 0 and 1. The title of the scale bar is
scaled with the plot and might disappear if the down-scaled text size is too small. Increasing
the height of the scale bar can sometimes be useful to increase the text size to make it more
visible in small plots.</p></dd>


<dt>scalebar_position</dt>
<dd><p>A numeric vector of length 2 specifying the position of the scale bar
relative to the plot area. Default is to place it in the top right corner.</p></dd>


<dt>features</dt>
<dd><p>A character vector of features to plot. These features need to be
fetchable with <code>link{FetchData}</code></p></dd>


<dt>slot</dt>
<dd><p>Slot to pull features values from</p></dd>


<dt>image_use</dt>
<dd><p>A character specifying image type to use</p></dd>


<dt>coords_use</dt>
<dd><p>A character specifying coordinate type to use</p></dd>


<dt>override_plot_dims</dt>
<dd><p>A logical specifying whether the image dimensions should
be used to define the plot area. Setting <code>override_plot_dims</code> can be useful
in situations where the tissue section only covers a small fraction of the capture
area, which will create a lot of white space in the plots.</p></dd>


<dt>min_cutoff, max_cutoff</dt>
<dd><p>A numeric value between 0-1 specifying either a lower
(<code>min_cutoff</code>) or upper (<code>max_cutoff</code>) limit for the data using <code><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></code>.
These arguments can be useful to make sure that the color map doesn't get dominated by outliers.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A patchwork object</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Note that you can only plot numeric features with <code>MapFeatures</code>,
for example: gene expression, QC metrics or dimensionality reduction vectors.
If you want to plot categorical features, use <code><a href="visualize-labels.html">MapLabels</a></code> instead.</p>
    </div>
    <div class="section level2">
    <h2 id="color-blending">color blending<a class="anchor" aria-label="anchor" href="#color-blending"></a></h2>
    

<p>Color blending can <strong>only</strong> be used with 2 or three features. If blending is activated,
the feature values will be rescaled and encoded as RGB colors. RGB allows for three channels
to be included, hence the reason why you can only use 2-3 features. When blending feature
values you will only get 1 plot per tissue section.</p>
<p>Colors can be mixed to produce new colors; for example, if two features have similar values
in one spot and are encoded as blue and red, the mixed color will be purple.</p>
<p><code>blend_order</code> allows you to flip the order of the features so that each feature
is provided with a color of choice. By default, the order is 1, 2, 3 which means that the
first feature is "red", the second is "green" and the last feature is "blue".</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other spatial-visualization-methods: 
<code><a href="AnglePlot.html">AnglePlot</a>()</code>,
<code><a href="FeatureViewer.html">FeatureViewer</a>()</code>,
<code><a href="ImagePlot.html">ImagePlot</a>()</code>,
<code><a href="MapFeaturesSummary.html">MapFeaturesSummary</a>()</code>,
<code><a href="MapLabelsSummary.html">MapLabelsSummary</a>()</code>,
<code><a href="visualize-labels.html">MapLabels</a>()</code>,
<code><a href="visualize-multiple-features.html">MapMultipleFeatures</a>()</code></p>
<p>Other spatial-visualization-methods: 
<code><a href="AnglePlot.html">AnglePlot</a>()</code>,
<code><a href="FeatureViewer.html">FeatureViewer</a>()</code>,
<code><a href="ImagePlot.html">ImagePlot</a>()</code>,
<code><a href="MapFeaturesSummary.html">MapFeaturesSummary</a>()</code>,
<code><a href="MapLabelsSummary.html">MapLabelsSummary</a>()</code>,
<code><a href="visualize-labels.html">MapLabels</a>()</code>,
<code><a href="visualize-multiple-features.html">MapMultipleFeatures</a>()</code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Ludvig Larsson</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ludvigla.github.io/semla/">semla</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"viridis"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"viridis"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://sjmgarnier.github.io/viridis/" class="external-link">viridis</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Load example Visium data</span></span></span>
<span class="r-in"><span><span class="va">se_mbrain</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/mousebrain"</span>, <span class="st">"se_mbrain"</span>, package <span class="op">=</span> <span class="st">"semla"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">se_mcolon</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/mousecolon"</span>, <span class="st">"se_mcolon"</span>, package <span class="op">=</span> <span class="st">"semla"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">se_merged</span> <span class="op">&lt;-</span> <span class="fu"><a href="merge.html">MergeSTData</a></span><span class="op">(</span><span class="va">se_mbrain</span>, <span class="va">se_mcolon</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Select features</span></span></span>
<span class="r-in"><span><span class="va">selected_features</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Clu"</span>, <span class="st">"Slc6a3"</span>, <span class="st">"Vip"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot selected features with custom colors</span></span></span>
<span class="r-in"><span><span class="fu">MapFeatures</span><span class="op">(</span><span class="va">se_merged</span>, features <span class="op">=</span> <span class="va">selected_features</span>, colors <span class="op">=</span> <span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">magma</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">11</span>, direction <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot selected features with color bars scaled individually for each feature and sample</span></span></span>
<span class="r-in"><span><span class="fu">MapFeatures</span><span class="op">(</span><span class="va">se_merged</span>, features <span class="op">=</span> <span class="va">selected_features</span>, scale <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot selected features and add custom labels for subplots</span></span></span>
<span class="r-in"><span><span class="va">se_merged</span><span class="op">$</span><span class="va">sample_id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="GetStaffli.html">GetStaffli</a></span><span class="op">(</span><span class="va">se_merged</span><span class="op">)</span><span class="op">@</span><span class="va">meta_data</span><span class="op">$</span><span class="va">sampleID</span> <span class="op">==</span> <span class="st">"1"</span>,</span></span>
<span class="r-in"><span>                              <span class="st">"mouse brain"</span>,</span></span>
<span class="r-in"><span>                              <span class="st">"mouse colon"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">MapFeatures</span><span class="op">(</span><span class="va">se_merged</span>, features <span class="op">=</span> <span class="va">selected_features</span>, label_by <span class="op">=</span> <span class="st">"sample_id"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot selected features arranged by rows instead of columns</span></span></span>
<span class="r-in"><span><span class="fu">MapFeatures</span><span class="op">(</span><span class="va">se_merged</span>, features <span class="op">=</span> <span class="va">selected_features</span>, arrange_features <span class="op">=</span> <span class="st">"row"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Blend features</span></span></span>
<span class="r-in"><span><span class="fu">MapFeatures</span><span class="op">(</span><span class="va">se_merged</span>, features <span class="op">=</span> <span class="va">selected_features</span>, blend <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The output is a patchwork object which is easy to manipulate</span></span></span>
<span class="r-in"><span><span class="va">selected_feature</span> <span class="op">&lt;-</span> <span class="st">"Th"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Move legend to right side of plot</span></span></span>
<span class="r-in"><span><span class="fu">MapFeatures</span><span class="op">(</span><span class="va">se_mbrain</span>, features <span class="op">=</span> <span class="va">selected_feature</span>, pt_size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">&amp;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"right"</span>,</span></span>
<span class="r-in"><span>        legend.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">0</span>, hjust <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="visualize-features-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Remove titles</span></span></span>
<span class="r-in"><span><span class="fu">MapFeatures</span><span class="op">(</span><span class="va">se_mbrain</span>, features <span class="op">=</span> <span class="va">selected_feature</span>, pt_size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">&amp;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        plot.subtitle <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="visualize-features-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create a dark theme</span></span></span>
<span class="r-in"><span><span class="fu">MapFeatures</span><span class="op">(</span><span class="va">se_mbrain</span>, features <span class="op">=</span> <span class="va">selected_feature</span>, pt_size <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>            colors <span class="op">=</span> <span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">viridis</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">11</span><span class="op">)</span><span class="op">)</span> <span class="op">&amp;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        panel.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        plot.subtitle <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        legend.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="visualize-features-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Add a background and axes to the plot</span></span></span>
<span class="r-in"><span><span class="fu">MapFeatures</span><span class="op">(</span><span class="va">se_mbrain</span>, features <span class="op">=</span> <span class="va">selected_feature</span>, pt_size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">&amp;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>panel.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"lightgray"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="visualize-features-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Move legend</span></span></span>
<span class="r-in"><span><span class="fu">MapFeatures</span><span class="op">(</span><span class="va">se_mbrain</span>, features <span class="op">=</span> <span class="va">selected_feature</span>, pt_size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">&amp;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>panel.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"lightgray"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        legend.justification <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="visualize-features-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Change title of fill aesthetic</span></span></span>
<span class="r-in"><span><span class="fu">MapFeatures</span><span class="op">(</span><span class="va">se_mbrain</span>, features <span class="op">=</span> <span class="va">selected_feature</span>, pt_size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">&amp;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Gene expression"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="visualize-features-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by <a href="https://github.com/ludvigla" class="external-link">Ludvig Larsson</a>, <a href="https://github.com/lfranzen" class="external-link">Lovisa Franzen</a>, <a href="https://www.spatialresearch.org/" class="external-link"><img src="reference/figures/sr-logo.png" height="36" alt="spatialresearch"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

