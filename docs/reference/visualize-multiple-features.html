<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Map numeric features or categorical labels — MapMultipleFeatures • semla</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Map numeric features or categorical labels — MapMultipleFeatures"><meta name="description" content="MapMultipleFeatures can be used to map multiple numeric feature on the
same tissue section(s). MapFeatures provides an option to map 2 or 3
features using RGB color blending, whereas MapMultipleFeatures can handle
more than 3 features. See details below for more information."><meta property="og:description" content="MapMultipleFeatures can be used to map multiple numeric feature on the
same tissue section(s). MapFeatures provides an option to map 2 or 3
features using RGB color blending, whereas MapMultipleFeatures can handle
more than 3 features. See details below for more information."><meta property="og:image" content="https://ludvigla.github.io/semla/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">semla</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/semla.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials"><li><h6 class="dropdown-header" data-toc-skip>Intro</h6></li>
    <li><a class="dropdown-item" href="../articles/getting_started.html">Get started</a></li>
    <li><a class="dropdown-item" href="../articles/subset_and_merge.html">Subset/merge</a></li>
    <li><a class="dropdown-item" href="../articles/visiumHD.html">VisiumHD</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Spatial visualization</h6></li>
    <li><a class="dropdown-item" href="../articles/numeric_features.html">Map numeric features</a></li>
    <li><a class="dropdown-item" href="../articles/categorical_features.html">Map categorical features</a></li>
    <li><a class="dropdown-item" href="../articles/advanced_visualization.html">Advanced visualization</a></li>
    <li><a class="dropdown-item" href="../articles/feature_viewer.html">Feature viewer</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Spatial methods</h6></li>
    <li><a class="dropdown-item" href="../articles/radial_distances.html">Radial distances</a></li>
    <li><a class="dropdown-item" href="../articles/region_neighbors.html">Region neighbors</a></li>
    <li><a class="dropdown-item" href="../articles/spatial_statistics_for_labelled_spots.html">Statistics for labelled spots</a></li>
    <li><a class="dropdown-item" href="../articles/spatial_autocorrelation.html">Spatial autocorrelation</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Analysis</h6></li>
    <li><a class="dropdown-item" href="../articles/cell_type_mapping_with_NNLS.html">Cell type mapping</a></li>
    <li><a class="dropdown-item" href="../articles/digital_unrolling.html">Digital unrolling</a></li>
    <li><a class="dropdown-item" href="../articles/NNMF.html">Non-negative Matrix Factorization</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Image processing</h6></li>
    <li><a class="dropdown-item" href="../articles/images_and_coordinates.html">Images and spot coordinates</a></li>
    <li><a class="dropdown-item" href="../articles/mask_images.html">Image masking</a></li>
    <li><a class="dropdown-item" href="../articles/image_alignment.html">Image alignment</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/create_object.html">Create a Staffli object</a></li>
    <li><a class="dropdown-item" href="../articles/compare_cell_type_mapping_NNLS.html">Cell type mapping comparison</a></li>
    <li><a class="dropdown-item" href="../articles/cell_type_mapping_benchmark.html">Cell type mapping benchmark</a></li>
    <li><a class="dropdown-item" href="../articles/slide-seq.html">Slide-Seq data</a></li>
    <li><a class="dropdown-item" href="../articles/IF_data.html">IF data</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ludvigla/semla" aria-label="GitHub"><span class="fa fa-github"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Map numeric features or categorical labels</h1>

      <div class="d-none name"><code>visualize-multiple-features.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>MapMultipleFeatures</code> can be used to map multiple numeric feature on the
same tissue section(s). <code>MapFeatures</code> provides an option to map 2 or 3
features using RGB color blending, whereas <code>MapMultipleFeatures</code> can handle
more than 3 features. See details below for more information.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">MapMultipleFeatures</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Default S3 method</span></span>
<span><span class="fu">MapMultipleFeatures</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">dims</span>,</span>
<span>  spot_side <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"shared"</span>, <span class="st">"free"</span><span class="op">)</span>,</span>
<span>  crop_area <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pt_size <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  shape <span class="op">=</span> <span class="st">"point"</span>,</span>
<span>  pt_stroke <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  section_number <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  label_by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ncol <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  colors <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  coords_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pxl_col_in_fullres"</span>, <span class="st">"pxl_row_in_fullres"</span><span class="op">)</span>,</span>
<span>  return_plot_list <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  add_colorscale_text <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'Seurat'</span></span>
<span><span class="fu">MapMultipleFeatures</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">features</span>,</span>
<span>  scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"free"</span>, <span class="st">"shared"</span><span class="op">)</span>,</span>
<span>  slot <span class="op">=</span> <span class="st">"data"</span>,</span>
<span>  image_use <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  coords_use <span class="op">=</span> <span class="st">"raw"</span>,</span>
<span>  crop_area <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pt_size <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  pt_stroke <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  shape <span class="op">=</span> <span class="st">"point"</span>,</span>
<span>  spot_side <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  section_number <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  label_by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ncol <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  colors <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  override_plot_dims <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  max_cutoff <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  min_cutoff <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  return_plot_list <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  add_colorscale_text <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>An object</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Arguments passed to other methods</p></dd>


<dt id="arg-dims">dims<a class="anchor" aria-label="anchor" href="#arg-dims"></a></dt>
<dd><p>A tibble with information about the tissue sections. This information is used to
determine the limits of the plot area. If <code>dims</code> is not provided, the limits will be
computed directly from the spatial coordinates provided in <code>object</code>.</p></dd>


<dt id="arg-spot-side">spot_side<a class="anchor" aria-label="anchor" href="#arg-spot-side"></a></dt>
<dd><p>A numeric value or vector of values specifying the size of the spots in pixels
in the fullres image. Relevant for <code>"tile"</code> shape. Will default to each section's value
retrieved via GetScaleFactors: <code>GetScaleFactors()$spot_diameter_fullres)</code>.</p></dd>


<dt id="arg-scale">scale<a class="anchor" aria-label="anchor" href="#arg-scale"></a></dt>
<dd><p>A string specifying a scaling mode. See details below</p></dd>


<dt id="arg-crop-area">crop_area<a class="anchor" aria-label="anchor" href="#arg-crop-area"></a></dt>
<dd><p>A numeric vector of length 4 specifying a rectangular area to crop
the plots by. These numbers should be within 0-1. The x-axis is goes from left=0 to
right=1 and the y axis is goes from top=0 to bottom=1. The order of the values are
specified as follows: <code>crop_area = c(left, top, right, bottom)</code>. The crop area
will be used on all tissue sections and cannot be set for each section individually.
using crop areas of different sizes on different sections can lead to unwanted side
effects as the point sizes will remain constant. In this case it is better to generate
separate plots for different tissue sections.</p></dd>


<dt id="arg-pt-size">pt_size<a class="anchor" aria-label="anchor" href="#arg-pt-size"></a></dt>
<dd><p>A numeric value specifying the point size passed to <code>geom_point</code></p></dd>


<dt id="arg-shape">shape<a class="anchor" aria-label="anchor" href="#arg-shape"></a></dt>
<dd><p>A string specifying the shape to plot. Options are:
<code>c("point", "raster", "tile")</code>.</p></dd>


<dt id="arg-pt-stroke">pt_stroke<a class="anchor" aria-label="anchor" href="#arg-pt-stroke"></a></dt>
<dd><p>A numeric specifying the point stroke width</p></dd>


<dt id="arg-section-number">section_number<a class="anchor" aria-label="anchor" href="#arg-section-number"></a></dt>
<dd><p>An integer select a tissue section number to subset data by</p></dd>


<dt id="arg-label-by">label_by<a class="anchor" aria-label="anchor" href="#arg-label-by"></a></dt>
<dd><p>Character of length 1 providing a column name in <code>object</code> with
labels that can be used to provide a title for each subplot. This column should have
1 label per tissue section. This can be useful when you need to provide more detailed
information about your tissue sections.</p></dd>


<dt id="arg-ncol">ncol<a class="anchor" aria-label="anchor" href="#arg-ncol"></a></dt>
<dd><p>Integer value specifying the number of columns in the output patchwork.
This parameter will only have an effect when the number of features provided is 1.
Otherwise, the patchwork will be arranged based on the <code>arrange_features</code> parameter.</p></dd>


<dt id="arg-colors">colors<a class="anchor" aria-label="anchor" href="#arg-colors"></a></dt>
<dd><p>A character vector of colors to use for the color scale. The colors should
preferably consist of a set of colors from a scientific color palette designed for sequential
data. Some useful palettes are available in the <code>RColorBrewer</code>, <code>viridis</code> and
<code>scico</code> R packages.</p></dd>


<dt id="arg-coords-columns">coords_columns<a class="anchor" aria-label="anchor" href="#arg-coords-columns"></a></dt>
<dd><p>a character vector of length 2 specifying the names of the columns in
<code>object</code> holding the spatial coordinates</p></dd>


<dt id="arg-return-plot-list">return_plot_list<a class="anchor" aria-label="anchor" href="#arg-return-plot-list"></a></dt>
<dd><p>A logical specifying if a <code>patchwork</code> or a list of <code>ggplot</code> objects should be returned.
By default, a <code>patchwork</code> is returned, but it can sometimes be useful to obtain the list of <code>ggplot</code> objects
if you want to manipulate each sub plot independently.</p></dd>


<dt id="arg-add-colorscale-text">add_colorscale_text<a class="anchor" aria-label="anchor" href="#arg-add-colorscale-text"></a></dt>
<dd><p>A Logical specifying if labels should be added to
the color scales. The labels will be values from 0 to 1 ("low" to "high") and
the meaning of these values depend on the choice of <code>scale</code></p></dd>


<dt id="arg-features">features<a class="anchor" aria-label="anchor" href="#arg-features"></a></dt>
<dd><p>A character vector of features to plot. These features need to be
fetchable with <code>link{FetchData}</code></p></dd>


<dt id="arg-slot">slot<a class="anchor" aria-label="anchor" href="#arg-slot"></a></dt>
<dd><p>Slot to pull features values from</p></dd>


<dt id="arg-image-use">image_use<a class="anchor" aria-label="anchor" href="#arg-image-use"></a></dt>
<dd><p>A character specifying image type to use</p></dd>


<dt id="arg-coords-use">coords_use<a class="anchor" aria-label="anchor" href="#arg-coords-use"></a></dt>
<dd><p>A character specifying coordinate type to use</p></dd>


<dt id="arg-override-plot-dims">override_plot_dims<a class="anchor" aria-label="anchor" href="#arg-override-plot-dims"></a></dt>
<dd><p>A logical specifying whether the image dimensions should
be used to define the plot area. Setting <code>override_plot_dims</code> can be useful
in situations where the tissue section only covers a small fraction of the capture
area, which will create a lot of white space in the plots.</p></dd>


<dt id="arg-min-cutoff-max-cutoff">min_cutoff, max_cutoff<a class="anchor" aria-label="anchor" href="#arg-min-cutoff-max-cutoff"></a></dt>
<dd><p>A numeric value between 0-1 specifying either a lower
(<code>min_cutoff</code>) or upper (<code>max_cutoff</code>) limit for the data using <code><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></code>.
These arguments can be useful to make sure that the color map doesn't get dominated by outliers.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>patchwork</code> object</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>RGB color blending is only possible with 2 or 3 features. To visualize more
than 3 colors in the same plot, we can instead assign a specific color to each spot
depending on what feature has the highest value. This means that only the "dominant"
feature will be shown in each spot.</p>
<p>Before using <code>MapMultipleFeatures</code>, you should be aware that this type of visualization
will bias what is being shown. Preferably, the selected features should be selecting in
a way that they are mutually exclusive, i.e. expressed in different spatial locations.</p>
<p>Each spot is assigned one color determined by the dominant feature in that spot. For instance,
if cell type proportions are selected for the visualization, each cell type will be assigned a
specific color. Then, the cell type with the highest proportion value will determine the spot color</p>
<p>The values of the selected features will be rescaled for the visualization
depending on the choice of <code>scale</code>. If <code>scale="free"</code>, each numeric feature
will be scaled independently across the entire data set to have values ranging from 0 to 1.
This is most useful if the selected features have different scales and you want to
avoid some features dominating in many spots.</p>
<p>If you want to keep the relative differences between different feature, you can set
<code>scale="shared"</code>. In this case, the feature values will be scaled to have values
between 0 and 1 where 0 and 1 corresponds to the minimum and maximum value across
all feature values. This could for example be useful if you are visualizing cell type
proportions in which case the color intensity should reflect the relative differences.</p>
<p>The visualization produced with <code>MapMultipleFeatures</code> should be used with some caution. Because only 1 color
is selected for each spot, it is biased to focus on dominant features.
This makes it less meaningful to focus on the exact values and makes the interpretation
more qualitative. It can however be useful as a way to summarize the spatial distribution
of features that are expressed in different regions. It is best to map such features with
<code><a href="visualize-features.html">MapFeatures</a></code> first, before attempting to summarize them in one plot.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other spatial-visualization-methods:
<code><a href="AnglePlot.html">AnglePlot</a>()</code>,
<code><a href="FeatureViewer.html">FeatureViewer</a>()</code>,
<code><a href="ImagePlot.html">ImagePlot</a>()</code>,
<code><a href="visualize-features.html">MapFeatures</a>()</code>,
<code><a href="MapFeaturesSummary.html">MapFeaturesSummary</a>()</code>,
<code><a href="visualize-labels.html">MapLabels</a>()</code>,
<code><a href="MapLabelsSummary.html">MapLabelsSummary</a>()</code></p>
<p>Other spatial-visualization-methods:
<code><a href="AnglePlot.html">AnglePlot</a>()</code>,
<code><a href="FeatureViewer.html">FeatureViewer</a>()</code>,
<code><a href="ImagePlot.html">ImagePlot</a>()</code>,
<code><a href="visualize-features.html">MapFeatures</a>()</code>,
<code><a href="MapFeaturesSummary.html">MapFeaturesSummary</a>()</code>,
<code><a href="visualize-labels.html">MapLabels</a>()</code>,
<code><a href="MapLabelsSummary.html">MapLabelsSummary</a>()</code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Ludvig Larsson</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ludvigla.github.io/semla/">semla</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">se_mbrain</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/mousebrain"</span>, <span class="st">"se_mbrain"</span>, package <span class="op">=</span> <span class="st">"semla"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Map multiple features with non-overlapping expression patterns</span></span></span>
<span class="r-in"><span><span class="va">selected_features</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Th"</span>, <span class="st">"Prkcd"</span>, <span class="st">"Dsp"</span>, <span class="st">"Trh"</span>, </span></span>
<span class="r-in"><span>                        <span class="st">"Calb2"</span>, <span class="st">"Pitx2"</span>, <span class="st">"Arc"</span>, <span class="st">"Spink8"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Construct tibble with coordinates and feature values</span></span></span>
<span class="r-in"><span><span class="va">data_use</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html" class="external-link">bind_cols</a></span><span class="op">(</span><span class="fu"><a href="GetStaffli.html">GetStaffli</a></span><span class="op">(</span><span class="va">se_mbrain</span><span class="op">)</span><span class="op">@</span><span class="va">meta_data</span>, </span></span>
<span class="r-in"><span>                      <span class="fu"><a href="https://rdrr.io/pkg/SeuratObject/man/FetchData.html" class="external-link">FetchData</a></span><span class="op">(</span><span class="va">se_mbrain</span>, vars <span class="op">=</span> <span class="va">selected_features</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Construct a dims tibble</span></span></span>
<span class="r-in"><span><span class="va">dims</span> <span class="op">&lt;-</span> <span class="fu"><a href="GetStaffli.html">GetStaffli</a></span><span class="op">(</span><span class="va">se_mbrain</span><span class="op">)</span><span class="op">@</span><span class="va">image_info</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Composite plot</span></span></span>
<span class="r-in"><span><span class="fu">MapMultipleFeatures</span><span class="op">(</span><span class="va">data_use</span>, dims <span class="op">=</span> <span class="va">dims</span>, pt_size <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op">&amp;</span> </span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required namespace: ggnewscale</span>
<span class="r-plt img"><img src="visualize-multiple-features-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ludvigla.github.io/semla/">semla</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Load example Visium data</span></span></span>
<span class="r-in"><span><span class="va">se_mbrain</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/mousebrain"</span>,</span></span>
<span class="r-in"><span>                                 <span class="st">"se_mbrain"</span>,</span></span>
<span class="r-in"><span>                                 package <span class="op">=</span> <span class="st">"semla"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Select features to plot</span></span></span>
<span class="r-in"><span><span class="va">sel_features</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Th"</span>, <span class="st">"Trh"</span>, <span class="st">"Calb2"</span>, <span class="st">"Prkcd"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Map selected features</span></span></span>
<span class="r-in"><span><span class="fu"><a href="visualize-features.html">MapFeatures</a></span><span class="op">(</span><span class="va">se_mbrain</span>, features <span class="op">=</span> <span class="va">sel_features</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="visualize-multiple-features-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Summarize in one plot</span></span></span>
<span class="r-in"><span><span class="fu">MapMultipleFeatures</span><span class="op">(</span><span class="va">se_mbrain</span>,</span></span>
<span class="r-in"><span>                    features <span class="op">=</span> <span class="va">sel_features</span>,</span></span>
<span class="r-in"><span>                    pt_size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="visualize-multiple-features-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot with H&amp;E image</span></span></span>
<span class="r-in"><span><span class="va">se_mbrain</span> <span class="op">&lt;-</span> <span class="va">se_mbrain</span> <span class="op">|&gt;</span> <span class="fu"><a href="load-images.html">LoadImages</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ── <span style="font-weight: bold;">Loading H&amp;E images</span> ──</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Loading image from /private/var/folders/8r/bfm2m_q17znfk0m_8dt330tm0000gp/T/RtmpLHpYU7/temp_libpath305b1609463d/semla/extdata/mousebrain/spatial/tissue_lowres_image.jpg</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Scaled image from 600x565 to 400x377 pixels</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Saving loaded H&amp;E images as 'rasters' in Seurat object</span>
<span class="r-in"><span><span class="fu">MapMultipleFeatures</span><span class="op">(</span><span class="va">se_mbrain</span>, image_use <span class="op">=</span> <span class="st">"raw"</span>,</span></span>
<span class="r-in"><span>                    features <span class="op">=</span> <span class="va">sel_features</span>,</span></span>
<span class="r-in"><span>                    pt_size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="visualize-multiple-features-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/ludvigla" class="external-link">Ludvig Larsson</a>, <a href="https://github.com/lfranzen" class="external-link">Lovisa Franzen</a>, <a href="https://github.com/jemorlanes" class="external-link">Javier Escudero Morlanes</a>, <a href="https://www.spatialresearch.org/" class="external-link"><img src="reference/figures/sr-logo.png" height="36" alt="spatialresearch"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

